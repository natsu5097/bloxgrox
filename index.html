<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Blox Fruits Fan Wiki</title>
  <link rel="stylesheet" href="bloxgrox.css" />
</head>

<body>
  <!-- Header & Navigation -->
  <header>
    <h1>Blox Fruits Fan Wiki</h1>
    <button id="darkModeToggle">üåô Dark Mode</button>
    <nav id="navbar" aria-label="Main Navigation">
      <ul>
        <li><a href="#home">Home</a></li>
        <li><a href="#obtainment">Obtainment</a></li>
        <li><a href="#bloxfruit-info">Blox Fruit Info</a></li>
        <li><a href="#fruits">Fruits</a></li>
        <li><a href="#unobtainable-fruits">Unobtainable Fruits</a></li>
        <li><a href="#fighting-styles">Fighting Styles</a></li>
        <li><a href="#swords">Swords</a></li>
        <li><a href="#guns">Guns</a></li>
        <li><a href="#accessories">Accessories</a></li>
        <li><a href="#races">Races</a></li>
        <li><a href="#locations">Locations</a></li>
        <li><a href="#updates">Updates</a></li>
      </ul>
    </nav>
  </header>

  <!-- Filters -->
  <div id="filters">
    <button class="filter-btn" data-filter="fruits">Fruits</button>
    <button class="filter-btn" data-filter="fighting-styles">Fighting Styles</button>
    <button class="filter-btn" data-filter="guns">Guns</button>
    <button class="filter-btn" data-filter="accessories">Accessories</button>
    <button class="filter-btn" data-filter="races">Races</button>
    <button class="filter-btn" data-filter="locations">Locations</button>
    <button class="filter-btn" data-filter="unobtainable-fruits">Unobtainable Fruits</button>
  </div>

  <!-- Expand/Collapse -->
  <div id="expand-collapse">
    <button id="expandAll">Expand All</button>
    <button id="collapseAll">Collapse All</button>
  </div>

  <!-- Loading Spinner -->
  <div id="loadingSpinner">Loading...</div>

  <main>
    <!-- Search Bar -->
    <div id="search-container">
      <input 
        type="text" 
        id="search-bar" 
        placeholder="Search items... (Fruits, Swords, Guns, etc.)" 
        aria-label="Search items" />
      <button id="clear-search" aria-label="Clear search">√ó</button>
    </div>

    <!-- Home -->
    <section id="home">
      <h2>Welcome to Blox Fruits Fan Wiki</h2>
      <p>
        Blox Fruits are mysterious fruits that grant their user supernatural abilities when eaten. 
        They are the core mechanic of the game, as reflected in the game‚Äôs title. Each fruit has unique powers, 
        but users take damage if they stay in water too long. Some fruits provide immunities, movement buffs, 
        or defensive perks.
      </p>
      <p>
        Explore the sections below for details on fruits, weapons, races, and more. 
        This wiki uses a light blue theme for readability and modern design.
      </p>
    </section>

    <!-- Obtainment -->
    <section id="obtainment">
      <h2>Obtainment</h2>
      <p>
        Main ways to obtain Blox Fruits: purchase powers from the 
        <strong>Blox Fruit Dealer</strong>, buy a fruit from the 
        <strong>Blox Fruit Gacha</strong>, buy a <strong>Permanent Fruit</strong>, 
        or collect fruits that spawn hourly (45 minutes on weekends).
      </p>
      <p>
        Other ways: do the most damage in a <strong>Factory raid</strong>, 
        defend the <strong>Castle on the Sea</strong>, defeat a 
        <strong>Grand Brigade</strong> (Ship Raids), trade in Caf√©/Mansion, 
        be gifted a Permanent Fruit, or buy a <strong>Rocket Fruit</strong> 
        from Dog House (R$ 97). Limited events (like Halloween) also reward fruits.
      </p>
      <p>
        Rare methods include defeating the <strong>Tyrant of the Skies</strong>, 
        offering <strong>Azure Embers</strong>, or collecting a 
        <strong>Dragon Egg</strong>, which may grant Eagle, Kitsune, or Dragon Fruits.
      </p>
    </section>

    <!-- Blox Fruit Info -->
    <section id="bloxfruit-info">
      <h2>Blox Fruit Info</h2>
      <p>
        There are <strong>5 rarities</strong> of Blox Fruits:
      </p>
      <ul>
        <li><strong>Common</strong> (7 fruits) ‚Äî Cheapest, most likely to spawn.</li>
        <li><strong>Uncommon</strong> (6 fruits) ‚Äî Cheap fruits.</li>
        <li><strong>Rare</strong> (4 fruits) ‚Äî Mid-priced.</li>
        <li><strong>Legendary</strong> (11 fruits) ‚Äî Expensive.</li>
        <li><strong>Mythical</strong> (13 fruits) ‚Äî Very expensive, rarest spawn.</li>
      </ul>
      <p>
        In total: <strong>41 Fruits</strong> ‚Äî 21 Natural, 11 Elemental, 9 Beast.
      </p>
    </section>

    <!-- Fruits -->
    <section id="fruits">
      <h2>Blox Fruits</h2>
      <p>Core mechanic of the game, granting users special abilities. Divided by rarity.</p>
      <div id="fruits-sections"></div>
    </section>

    <!-- Unobtainable Fruits -->
    <section id="unobtainable-fruits">
      <h2>Unobtainable Fruits</h2>
      <p>These fruits are not currently obtainable but appear in lore or events.</p>
      <div id="unobtainable-fruits-sections"></div>
    </section>

    <!-- Fighting Styles -->
    <section id="fighting-styles">
      <h2>Fighting Styles</h2>
      <p>
        Fighting styles are melee combat techniques. 
        Examples include Combat, Dark Step, Electric, Water Kung Fu, Dragon Breath, 
        Superhuman, Death Step, Sharkman Karate, Electric Claw, Dragon Talon, Godhuman, Sanguine Art.
      </p>
      <table id="fighting-styles-table">
        <thead>
          <tr>
            <th>Image</th>
            <th>Name</th>
            <th>Price</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- Swords -->
    <section id="swords">
      <h2>Swords</h2>
      <p>Swords are close-combat weapons, ranging from Common to Mythical rarity.</p>
      <div id="swords-sections"></div>
    </section>

    <!-- Guns -->
    <section id="guns">
      <h2>Guns</h2>
      <p>Ranged weapons with various abilities, from Slingshots to legendary Serpent Bows.</p>
      <div id="guns-sections"></div>
    </section>

    <!-- Accessories -->
    <section id="accessories">
      <h2>Accessories</h2>
      <p>Accessories grant buffs such as extra damage, health, or unique effects.</p>
      <div id="accessories-sections"></div>
    </section>

    <!-- Races -->
    <section id="races">
      <h2>Races</h2>
      <p>Races provide unique perks and evolutions for PvE and PvP.</p>
      <div id="races-sections"></div>
    </section>

    <!-- Locations -->
    <section id="locations">
      <h2>Locations</h2>
      <p>Explore the three seas, each with unique islands, bosses, and quests.</p>
      <div id="locations-sections"></div>
    </section>

    <!-- Updates -->
    <section id="updates">
      <h2>Updates</h2>
      <p>Recent updates include new fruits, weapons, and balance changes.</p>
      <table id="updates-table">
        <thead>
          <tr>
            <th>Version</th>
            <th>Date</th>
            <th>Details</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <p>
      &copy; 2025 Blox Fruits Fan Wiki. Inspired by 
      <a href="https://blox-fruits.fandom.com/wiki/Blox_Fruits_Wiki">Blox Fruits Wiki</a>. 
      All rights reserved to original creators.
    </p>
  </footer>

  <!-- Scroll Button -->
  <button id="scrollTopBtn" aria-label="Scroll to top">‚Üë</button>
<script>
    fetch('data.json')
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            console.log("‚úÖ JSON loaded successfully:", data);
            // ... your rendering code here ...
        })
        .catch(error => {
            console.error("‚ùå Error loading JSON:", error);
            const main = document.querySelector("main");
            if (main) {
                main.insertAdjacentHTML(
                    "afterbegin",
                    `<div style="background:#ffdddd;color:#900;padding:1em;margin:1em 0;border:1px solid red;">
                        Failed to load <b>data.json</b>: ${error.message}
                     </div>`
                );
            }
        });
                function renderGroupedTables(groups, containerId, columns) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = '';

                    Object.keys(groups).forEach(rarity => {
                        const section = document.createElement('section');
                        section.classList.add('collapsible-section');

                        const header = document.createElement('h3');
                        header.textContent = rarity;
                        header.classList.add('collapsible-header');

                        const tableWrapper = document.createElement('div');
                        tableWrapper.classList.add('collapsible-content');

                        const table = document.createElement('table');
                        const thead = document.createElement('thead');
                        thead.innerHTML = `<tr>${columns.map(c => `<th>${c.header}</th>`).join('')}</tr>`;
                        table.appendChild(thead);

                        const tbody = document.createElement('tbody');
                        groups[rarity].forEach(item => {
                            const row = document.createElement('tr');
                            row.innerHTML = columns.map(c =>
                                c.key === 'image_url'
                                    ? `<td><img src="${item[c.key] || 'images/placeholder.png'}" alt="${item.name || ''}" style="width:40px;height:40px;"></td>`
                                    : `<td>${item[c.key] !== undefined ? item[c.key] : ''}</td>`
                            ).join('');
                            tbody.appendChild(row);
                        });
                        table.appendChild(tbody);
                        tableWrapper.appendChild(table);

                        section.appendChild(header);
                        section.appendChild(tableWrapper);
                        container.appendChild(section);

                        header.addEventListener('click', () => {
                            tableWrapper.classList.toggle('active');
                        });
                    });
                }

                const fruitColumns = [
                    { header: 'Image', key: 'image_url' },
                    { header: 'Name', key: 'name' },
                    { header: 'Type', key: 'type' },
                    { header: 'Price (Money)', key: 'price_money' },
                    { header: 'Price (Robux)', key: 'price_robux' },
                    { header: 'Description', key: 'description' }
                ];
                renderGroupedTables(groupByRarity(data.fruits), 'fruits-sections', fruitColumns);

                const swordColumns = [
                    { header: 'Image', key: 'image_url' },
                    { header: 'Name', key: 'name' },
                    { header: 'Rarity', key: 'rarity' },
                    { header: 'Price (Money)', key: 'price_money' },
                    { header: 'Price (Robux)', key: 'price_robux' },
                    { header: 'Description', key: 'description' }
                ];
                renderGroupedTables(groupByRarity(data.swords), 'swords-sections', swordColumns);

                const fightingStylesTableBody = document.querySelector('#fighting-styles-table tbody');
                data.fightingStyles.forEach(style => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td><img src="${style.image_url || 'images/placeholder.png'}" alt="${style.name || ''}" style="width:40px;height:40px;"></td>
                        <td>${style.name || ''}</td>
                        <td>${style.price_money ? style.price_money.toLocaleString() : ''}</td>
                        <td>${style.description || ''}</td>
                    `;
                    fightingStylesTableBody.appendChild(row);
                });

                const gunColumns = [
                    { header: 'Image', key: 'image_url' },
                    { header: 'Name', key: 'name' },
                    { header: 'Rarity', key: 'rarity' },
                    { header: 'Price (Money)', key: 'price_money' },
                    { header: 'Description', key: 'description' }
                ];
                renderGroupedTables(groupByRarity(data.guns), 'guns-sections', gunColumns);

                const accessoryColumns = [
                    { header: 'Image', key: 'image_url' },
                    { header: 'Name', key: 'name' },
                    { header: 'Rarity', key: 'rarity' },
                    { header: 'Price (Money)', key: 'price_money' },
                    { header: 'Description', key: 'description' }
                ];
                renderGroupedTables(groupByRarity(data.accessories), 'accessories-sections', accessoryColumns);

                const raceColumns = [
                    { header: 'Image', key: 'image_url' },
                    { header: 'Name', key: 'name' },
                    { header: 'Description', key: 'description' }
                ];
                renderGroupedTables({ "All Races": data.races }, 'races-sections', raceColumns);

                const locationColumns = [
                    { header: 'Image', key: 'image_url' },
                    { header: 'Name', key: 'name' },
                    { header: 'Description', key: 'description' }
                ];
                renderGroupedTables({ "Game Worlds": data.locations }, 'locations-sections', locationColumns);

                const updatesTableBody = document.querySelector('#updates-table tbody');
                data.updates.forEach(update => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${update.version}</td>
                        <td>${update.date}</td>
                        <td>${update.details}</td>
                    `;
                    updatesTableBody.appendChild(row);
                });

                const searchBar = document.getElementById('search-bar');
                searchBar.addEventListener('input', () => {
                    const query = searchBar.value.toLowerCase();

                    function filterTable(containerId) {
                        const container = document.getElementById(containerId);
                        if (!container) return;
                        const rows = container.querySelectorAll('tbody tr');
                        rows.forEach(row => {
                            const text = row.innerText.toLowerCase();
                            row.style.display = text.includes(query) ? '' : 'none';
                        });
                    }

                    filterTable('fruits-sections');
                    filterTable('swords-sections');
                    filterTable('guns-sections');
                    filterTable('accessories-sections');
                    filterTable('races-sections');
                    filterTable('locations-sections');

                    const fsRows = document.querySelectorAll('#fighting-styles-table tbody tr');
                    fsRows.forEach(row => {
                        const text = row.innerText.toLowerCase();
                        row.style.display = text.includes(query) ? '' : 'none';
                    });

                    const updateRows = document.querySelectorAll('#updates-table tbody tr');
                    updateRows.forEach(row => {
                        const text = row.innerText.toLowerCase();
                        row.style.display = text.includes(query) ? '' : 'none';
                    });
                });
            // Remove this extra closing parenthesis and curly brace
            // .catch(error => console.error('Error loading JSON:', error));

        const scrollTopBtn = document.getElementById('scrollTopBtn');

        window.addEventListener('scroll', () => {
            if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
                scrollTopBtn.style.display = "block";
            } else {
                scrollTopBtn.style.display = "none";
            }
        });

        scrollTopBtn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        const clearBtn = document.getElementById('clear-search');
        searchBar.addEventListener('input', () => {
            clearBtn.style.display = searchBar.value ? 'inline-block' : 'none';
        });

        clearBtn.addEventListener('click', () => {
            searchBar.value = '';
            clearBtn.style.display = 'none';
            searchBar.dispatchEvent(new Event('input'));
        });
        document.addEventListener("DOMContentLoaded", () => {
      const body = document.body;
      const darkToggle = document.getElementById("darkModeToggle");
      const links = document.querySelectorAll("#navbar a");
      const filterBtns = document.querySelectorAll(".filter-btn");
      const spinner = document.getElementById("loadingSpinner");

      // Dark mode toggle
      darkToggle.addEventListener("click", () => {
        body.classList.toggle("dark");
        darkToggle.textContent = body.classList.contains("dark") ? "‚òÄÔ∏è Light Mode" : "üåô Dark Mode";
      });

      // Active nav link on scroll
      window.addEventListener("scroll", () => {
        let current = "";
        document.querySelectorAll("section").forEach(sec => {
          const secTop = sec.offsetTop - 80;
          if (scrollY >= secTop) current = sec.id;
        });
        links.forEach(a => {
          a.classList.remove("active");
          if (a.getAttribute("href") === "#" + current) a.classList.add("active");
        });
      });

      // Filters
      filterBtns.forEach(btn => {
        btn.addEventListener("click", () => {
          const target = btn.dataset.filter;
          document.querySelectorAll("section").forEach(sec => {
            sec.style.display = sec.id === target ? "block" : "none";
          });
        });
      });

      // Expand/Collapse All
      document.getElementById("expandAll").addEventListener("click", () => {
        document.querySelectorAll(".collapsible-content").forEach(c => c.classList.add("active"));
      });
      document.getElementById("collapseAll").addEventListener("click", () => {
        document.querySelectorAll(".collapsible-content").forEach(c => c.classList.remove("active"));
      });

      // Search highlight
      const searchBar = document.getElementById("search-bar");
      searchBar.addEventListener("input", () => {
        const text = searchBar.value.toLowerCase();
        document.querySelectorAll("section").forEach(sec => {
          sec.querySelectorAll("td").forEach(td => {
            td.innerHTML = td.textContent.replace(new RegExp(text, "gi"), match => `<span class="highlight">${match}</span>`);
          });
        });
      });

      // Fake loading (for demo, remove if data loads dynamically)
      spinner.style.display = "block";
      setTimeout(() => spinner.style.display = "none", 1500);
    });
    </script>
</body>
</html>
